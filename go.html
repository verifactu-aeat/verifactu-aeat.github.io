<!doctype html>
<html lang="es">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>API REST: Verifactu</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-Zenh87qX5JnK2Jl0vWa8Ck2rdkQ2Bzep5IDxbcnCeuOxjzrPF/et3URy9Bv1WTRi" crossorigin="anonymous">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.9.1/font/bootstrap-icons.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Sans:wght@400&display=swap" rel="stylesheet">

    <!-- Custom styles for this page -->
    <link href="go.css" rel="stylesheet">

</head>
<body style="font-family: 'Fira Sans', sans-serif;">
    <!-- Modal alta usuario -->
    <div class="modal fade" id="modalUserActivation" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Active su cuenta</h5>
                </div>
                <div class="modal-body">
                    <p>
                        Hemos envíado un correo de activación a la dirección especificada. Por favor,
                        acceda a su cliente de correo y pulse el enlace de activación. No olvide revisar
                        su bandeja de spam si no ha recibido el correo.
                    </p>
                    <p>
                        Si quiere volver a recibir el correo de activación pulse <a href="javascript:Go.Sign.ResetUser();"> aquí</a>.
                    </p>
                    <p>
                        Si tiene problemas con la activación de su cuenta, por favor, pongase en contacto con nosotros en el mail <strong>support@irenesolutions.com</strong>.
                    </p>

                </div>
                <div class="modal-footer">
                    <button type="button" class="w-100 btn btn-md btn-dark mt-1 mb-3" onclick="Go.Sign.CloseModalUserActivation();">Acceder</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal activación usuario -->
    <div class="modal fade" id="modalUserActivationOk" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Usuario activado correctamente.</h5>
                </div>
                <div class="modal-body">
                    <p>
                        Su usuario ha sido activado correctamente.
                    </p>
                    <p>
                        Ya puede utilizar el API Verifactu con su
                        ServiceKey.
                    </p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="w-100 btn btn-md btn-dark mt-1 mb-3" onclick="Go.Sign.CloseModalUserActivationOk();">Acceder</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Modal código QR -->
    <div class="modal fade" id="modalQr" data-bs-backdrop="static" data-bs-keyboard="false" tabindex="-1">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title">Código QR</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body text-center">
                    <img id="imgQr" />
                </div>
                <div class="modal-footer">
                    <p id="txQr"></p>
                </div>

            </div>
        </div>
    </div>
    <!-- Formulario de acceso -->
    <main class="form-signin w-100 m-auto">
        <form class="px-5 py-4 border rounded-2 shadow text-center">
            <img class="mb-2" src="../img/logo-heart.png" alt="Irene Solutions SL" width="90" height="90">
            <div class="form-floating m-3">
                <input id="Sign.Credentials.UserID" type="email" class="form-control" placeholder="name@example.com" onkeydown="Go.Ui.TabOnKeyEnter(event, 'Sign.Credentials.UserPass');">
                <label for="Sign.Credentials.UserID">Dirección mail</label>
            </div>
            <div class="form-floating m-3">
                <input id="Sign.Credentials.UserPass" type="password" class="form-control" placeholder="Password" onkeydown="Go.Ui.TabOnKeyEnter(event, 'btEnter');">
                <label for="Sign.Credentials.UserPass">Contraseña</label>
            </div>
            <div class="form-floating mx-3">
                <a id="btEnter" class="w-100 btn btn-md btn-dark mt-1 mb-3" href="javascript:Go.Sign.ButtonEnter();">
                    <span id="spinnerBtEnter" class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                    <i class="bi bi-key"></i> Adelante
                </a>
            </div>
        </form>
    </main>
    <!-- Notificaciones -->
    <div class="position-fixed bottom-0 end-0 p-3" style="z-index: 11">
        <div id="liveToast" class="toast hide" role="alert" aria-live="assertive" aria-atomic="true">
            <div class="toast-header">
                <img src="../img/logo-heart.png" class="rounded me-2" alt="Irene Solutions SL" height="35" width="35">
                <strong class="me-auto">API REST Verifactu</strong>
                <small></small>
                <button type="button" class="btn-close" data-bs-dismiss="toast" aria-label="Close"></button>
            </div>
            <div class="toast-body">
                <p>
                    Introduce tu mail y tu contraseña:
                </p>
                <div class="alert alert-secondary my-4 py-4">
                    <ul class="list-group list-group-flush">
                        <li class="list-group-item bg-light user-select-none">Si no estás registrado, realizaremos el registro.</li>
                        <li class="list-group-item bg-light user-select-none">Si ya lo estás, accederás a tu panel.</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- Panel usuario -->
    <main class="form-panel w-100 h-100 d-none">
        <!-- Barra menu -->
        <nav class="navbar navbar-expand-lg border-bottom border-secondary border-opacity-75">
            <div class="container-fluid">
                <img src="../img/logo-heart.png" alt="Irene Solutions SL" width="90" height="90" style="margin-top:-1rem;">
                <a class="navbar-brand fs-2 text-white bg-secondary bg-gradient p-2 border border-1 rounded-2 d-none d-sm-block d-sm-none d-md-block" href="#">VeriFactu REST API (Entorno de pruebas)</a>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse ps-4" id="navbarSupportedContent">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0 pt-3 ps-4">
                        <li class="nav-item px-4 mx-4 p-1">
                            <a id="_formQuickstart" class="nav-link active" aria-current="page" href="javascript:Go.Panel.Show('formQuickstart');">Quickstart</a>
                        </li>
                        <li class="nav-item px-4 mx-4 p-1">
                            <a id="_formTest" class="nav-link" aria-current="page" href="javascript:Go.Panel.Show('formTest');">Endpoints</a>
                        </li>
                        <li class="nav-item px-4 mx-4 p-1">
                            <a id="_formFiles" class="nav-link" href="javascript:Go.Panel.Show('formFiles');">Envíos</a>
                        </li>
                        <li class="nav-item px-4 mx-4 p-1">
                            <a id="_formDoc" class="nav-link" href="javascript:Go.Panel.Show('formDoc');">Documentación</a>
                        </li>
                    </ul>
                    <a href="#" class="d-block link-dark text-decoration-none">
                        <div id="Panel.Initial" class="border rounded-circle bg-dark text-light text-center" style="font-size:1.7rem;font-weight:900;width:3rem;height:3rem;">M</div>
                    </a>
                </div>
            </div>
        </nav>
        <!-- Contenido -->
        <div class="container">
            <!-- Panel Inicio Rapido -->
            <form id="formQuickstart" class="py-4 m-4">
                <!-- Introducción -->
                <div class="shadow-sm p-3 mb-5 bg-body rounded">
                    <h1 class="fw-bolder">Quickstart</h1>
                    <br />
                    <p>
                        Cumplir con VeriFactu es más fácil de lo que imaginas. A continuación, te explicamos los pasos básicos:
                    </p>
                    <ol>
                        <li><strong>Generación del código QR:</strong><br />Incluye un código QR en las facturas que emites, generalmente en formato PDF. Puedes obtener un bitmap con el QR mediante nuestra API REST.</li>
                        <li><strong>Envío de información a la AEAT:</strong><br />Utiliza nuestra API REST para enviar los datos de tus facturas al sistema de la Agencia Tributaria Española (AEAT).</li>
                    </ol>
                    <br />
                    <h4>Entorno de Pruebas</h4>
                    <br />
                    <p>
                        Este entorno está diseñado para que puedas realizar todas las pruebas que necesites. Ten en cuenta que al trabajar en este entorno, los envíos no tienen validez legal y no afectan tu situación fiscal.
                    </p>
                    <br />
                    <h4>Acceso al Entorno de Producción</h4>
                    <br />
                    <p>
                        Si deseas acceder al entorno de producción, envía un correo electrónico a <mark><strong>info@irenesolutions.com</strong></mark> indicando tu solicitud. Te guiaremos en los pasos necesarios para completar el proceso.
                    </p>
                    <br />
                    <h4>Soporte y Sugerencias</h4>
                    <br />
                    <p>
                        Para cualquier consulta o sugerencia, no dudes en contactarnos también a través de <mark><strong>info@irenesolutions.com</strong></mark>.
                    </p>
                    <p>
                        Gracias por colaborar y ayudarnos a mejorar nuestra API. ¡Estamos aquí para ayudarte!
                    </p>

                </div>
                <!-- 1. Generación código QR -->
                <div class="shadow-sm p-3 mb-5 bg-body rounded">
                    <br />
                    <h3 class="fw-bold">1. Generación del código QR</h3>
                    <br />
                    <p>
                        Debemos incluir un código QR en nuestra facturas según las <a target="_blank" href="https://www.agenciatributaria.es/static_files/AEAT_Desarrolladores/EEDD/IVA/VERI-FACTU/DetalleEspecificacTecnCodigoQRfactura.pdf">especificaciones establecidas por la AEAT</a>.
                        Mediante ese código QR el comprador puede comprobar si la factura ha sido comunicada a la AEAT y si los datos comunicados son correctos.
                    </p>
                    <br />
                    <div class="row">
                        <div class="col-md-4 m-2 bg-img border">
                            <div class="bg-img-text">
                                <p>Ejemplo de factura con código QR de VERI*FACTU. Si escanea el código QR puede comprobar la validez de la misma.</p>
                            </div>
                        </div>
                        <div class="col-md-7 p-2 m-2 border">
                            <p>
                                El Endpoint para obtener el código QR es:
                            </p>
                            <p>
                                <code>https://facturae.irenesolutions.com:8050/Kivu/Taxes/Verifactu/Invoices/GetQrCode</code>
                            </p>
                            <p>
                                Método:
                            </p>
                            <p>
                                <code>POST</code>
                            </p>
                            <p>
                                Body JSON (<i class="bi bi-exclamation-triangle-fill"></i> No requerido encabezado Authorization, ServiceKey en body):
                            </p>
                            <p>
                                <textarea id="Panel.Request.BodyQr" cols=50 rows=10 placeholder="Request" style="font-size:0.9rem;"></textarea>
                            </p>
                            <p>
                                <a class="w-100 btn btn-md btn-dark mt-1 mb-3" href="javascript:Go.Panel.TestQr();">Pruebalo tu mismo</a>
                            </p>
                        </div>
                    </div>
                </div>
                <!-- 2. Envío de información a la AEAT -->
                <div class="shadow-sm p-3 mb-5 bg-body rounded">
                    <br />
                    <p>
                        <h3 class="fw-bold">2. Envío de información a la AEAT</h3>
                        <br />
                        Cuando emitimos nuestra factura con el código QR debemos enviarla a la AEAT para que el código QR de validación de un resultado correcto.
                    </p>
                    <div class="row">
                        <div class="col-md-8 p-2 m-4 border">
                            <p>
                                El Endpoint para enviar una factura es:
                            </p>
                            <p>
                                <code>https://facturae.irenesolutions.com:8050/Kivu/Taxes/Verifactu/Invoices/Create</code>
                            </p>
                            <p>
                                Método:
                            </p>
                            <p>
                                <code>POST</code>
                            </p>
                            <p>
                                Body JSON (<i class="bi bi-exclamation-triangle-fill"></i> No requerido encabezado Authorization, ServiceKey en body):
                            </p>
                            <p>
                                <textarea id="Panel.Request.BodySend" cols=50 rows=10 placeholder="Request" style="font-size:0.9rem;"></textarea>
                            </p>
                            <p>
                                <a class="w-100 btn btn-md btn-dark mt-1 mb-3" href="javascript:Go.Panel.TestSend();">Pruebalo tu mismo</a>
                            </p>
                        </div>
                    </div>
                </div>
            </form>
            <!-- Panel test API REST -->
            <form id="formTest" class="px-5 py-4 d-none">
                <div class="border rounded-2 p-2 m-2 shadow ">
                    <h5 style="text-align:left !important;">Datos de acceso</h5>
                    <div class="row p-2">
                        <div class="col-md-4">
                            <label class="form-label" for="Panel.UserID" style="width: 95%; text-align:left !important;">Usuario</label>
                            <div class="input-group mb-3">
                                <input id="Panel.UserID" type="email" class="form-control" placeholder="name@example.com" onkeydown="Go.Ui.TabOnKeyEnter(event, 'Panel.ServiceKey');" readonly>
                            </div>
                        </div>
                        <div class="col-md-8">
                            <label for="Panel.ServiceKey" class="form-label" style="width: 95%; text-align:left !important;">ServiceKey</label>
                            <div class="input-group mb-3">
                                <input id="Panel.ServiceKey" type="text" class="form-control" placeholder="Panel.ServiceKey" aria-label="Panel.ServiceKey" aria-describedby="bt-copy-clipboard" onkeydown="Go.Ui.TabOnKeyEnter(event, 'Panel.ServiceKey');" readonly>
                                <button class="btn btn-outline-dark" type="button" id="bt-copy-clipboard" data-bs-toggle="tooltip" data-bs-title="Copiar al portapapeles" onclick="Go.Panel.ButtonCopyServiceKeyToClipboard();">
                                    <i class="bi bi-clipboard"></i>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="border rounded-2 p-2 m-2 shadow ">
                    <h5 style="text-align:left !important;">Seleccione el Enpoint a probar, pulse 'Ejecutar' y vea el resultado de la llamada POST</h5>
                    <div class="row p-2">
                        <div class="col-md-3 pt-4">
                            <select class="form-select" id="Panel.EpMode" aria-label="Enpoints">
                                <option value="00" selected>Endpoint creación de facturas</option>
                                <option value="01">Endpoint anulación facturas</option>
                                <option value="02">Endpoint generación código QR</option>
                                <option value="03">Endpoint consulta emisores</option>
                                <option value="04">Endpoint consulta envíos realizados</option>
                                <option value="05">Endpoint creación de facturas (Ejemplo factura simplificada)</option>
                                <option value="06">Endpoint creación de facturas (Ejemplo recargo equivalencia)</option>
                                <option value="07">Endpoint creación de facturas (Ejemplo factura rectificativa)</option>
                                <option value="08">Endpoint creación de facturas (Factura a la Administración con IVA diferido)</option>
                                <option value="09">Endpoint creación de facturas (Factura emitida no sujeta a IVA en virtud del artículo 7, 14 u otros)</option>
                            </select>
                        </div>
                        <div class="col-md-9">
                            <label for="Panel.Request.Url"></label>
                            <input id="Panel.Request.Url" type="text" class="form-control" disabled>
                        </div>
                    </div>
                </div>
                <p class="pt-3">
                    Puede editar el JSON de entrada para ver los distintos resultados:
                </p>
                <div class="row py-3">
                    <div class="col-md-6">
                        <textarea id="Panel.Request.Body" cols=50 rows=10 placeholder="Request"></textarea>
                    </div>
                    <div class="col-md-6">
                        <textarea id="Panel.Request.Response" cols=50 rows=10 disabled placeholder=""></textarea>
                    </div>
                    <div class="row py-1">
                        <div class="col-md-6">
                            <a id="btPost" class="btn btn-md btn-dark mt-1 mb-3 float-end" href="javascript:Go.Panel.ButtonPost();">
                                <span id="timer" class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                                <i class="bi bi-send"></i> Ejecutar
                            </a>
                        </div>
                        <div class="col-md-6">
                            <a id="btJson" class="btn btn-md btn-dark mt-1 mb-3 float-end disabled" href="javascript:Go.Panel.ButtonDownload();">
                                <span id="timerd" class="spinner-border spinner-border-sm d-none" role="status" aria-hidden="true"></span>
                                <i class="bi bi-filetype-json"></i> Descargar
                            </a>
                        </div>
                    </div>
                </div>
            </form>
            <!-- Panel Envíos -->
            <form id="formFiles" class="px-5 py-4 d-none">
                <h5 style="text-align:left !important;">Seleccione emisor de documentos a consultar</h5>
                <div class="row">
                    <div class="col-md-3 pt-4">
                        <select class="form-select" id="Panel.SellerID" aria-label="Emisores">
                        </select>
                    </div>
                    <div class="col-md-3 pt-4">
                        <select class="form-select" id="Panel.PeriodID" aria-label="Periodos">
                        </select>
                    </div>
                    <div class="col-md-6 pt-4">
                        <div class="input-group mb-3">
                            <input id="invoiceFilter" type="text" class="form-control" aria-label="Buscar facturas" onkeyup="Go.Panel.FilterInvoices(this);" onpaste="Go.Panel.FilterInvoices(this);" oninput="Go.Panel.FilterInvoices(this);">
                            <span class="input-group-text"><i class="bi bi-search"></i></span>
                        </div>
                    </div>
                </div>
                <div class="row p-2">
                    <div class="table-responsive" style="font-size:0.85rem;">
                        <table class="table table-striped">
                            <thead>
                                <tr>
                                    <th scope="col">#</th>
                                    <th scope="col">Fecha</th>
                                    <th scope="col">Id. Comprador</th>
                                    <th scope="col">Nombre comprador</th>
                                    <th scope="col" style="text-align: right;">Importe</th>
                                    <th scope="col">Resultado</th>
                                </tr>
                            </thead>
                            <tbody id="invoices">
                            </tbody>
                        </table>
                    </div>
                </div>
            </form>
            <!-- Panel Documentación -->
            <form id="formDoc" class="py-4 m-4 d-none">
                <h1 style="text-align: left !important;">Invoice</h1>
                <br />
                <p>
                    Todos los Enpoints reciben como parámetro de entrada un objeto <code>Invoice</code>. El número de parámetros obligatorios difiere
                    de la operación que estemos ejecutando (alta, anulación o generación de código QR de validación).
                </p>
                <br />
                <p class="pb-4">
                    En la siguiente tabla se describe el valor de las propiedades de <code>Invoice</code>:
                </p>
                <div class="table-responsive">
                    <table class="table table-striped align-start">
                        <thead>
                            <tr>
                                <th scope="col">Propiedad</th>
                                <th scope="col">Descripción</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>Status</code></td>
                                <td>
                                    <p>
                                        Indica el estado del documento. Si queremos realizar un envío definitio al servidor de la AEAT debe contener cualquier valor distinto de 'DRAFT'. Sin
                                        embargo si lo que queremos es obtener un borrador con el XML del registro y la imágen del código QR necesitamos consignar el valor 'DRAFT'.
                                    </p>
                                    <p>
                                        Alfanumérico(20).
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>InvoiceType</code></td>
                                <td>
                                    <p>
                                        Su valor por defecto es F1. Se corresponde con el valor del campo TipoFactura en las especificaciones de VERI*FACTU. El significado de este campo es la Clave del tipo de factura y
                                        los valores adminitdos se corresponden con la lista L2 sgúna las siguientes equivalencias:
                                    </p>
                                    <p>
                                        <ul style="list-style-type:square; padding-left: 4rem;">
                                            <li>F1: Factura (art. 6, 7.2 y 7.3 del RD 1619/2012).</li>
                                            <li>F2: Factura Simplificada y Facturas sin identificación del destinatario art. 6.1.d) RD 1619/2012.</li>
                                            <li>F3: Factura emitida en sustitución de facturas simplificadas facturadas y declaradas.</li>
                                            <li>R1: Factura Rectificativa (Error fundado en derecho y Art. 80 Uno Dos y Seis LIVA).</li>
                                            <li>
                                                R2: Factura Rectificativa (Art. 80.3). Cuando el destinatario
                                                de las operaciones sujetas al Impuesto no haya hecho
                                                efectivo el pago de las cuotas repercutidas y siempre que,
                                                con posterioridad al devengo de la operación, se dicte
                                                auto de declaración de concurso.
                                            </li>
                                            <li>
                                                R3: Factura Rectificativa (Art. 80.4).  Cuando los créditos
                                                correspondientes a las cuotas repercutidas por las
                                                operaciones gravadas sean total o parcialmente incobrables.
                                            </li>
                                            <li>R4: Factura Rectificativa (Resto).</li>
                                            <li>R5: Factura Rectificativa en facturas simplificadas facturadas y declaradas.</li>
                                        </ul>
                                    </p>

                                </td>
                            </tr>
                            <tr>
                                <td><code>InvoiceID</code></td>
                                <td>
                                    <p>
                                        Identificador de la factura. Su valor representa el campo NumSerieFactura, Nº Serie+Nº Factura  que identifica a la factura emitida.
                                    </p>
                                    <p>
                                        Alfanumérico(60).
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>InvoiceDate</code></td>
                                <td>
                                    <p>
                                        Fecha de expedición de la factura.
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>SellerID</code></td>
                                <td>
                                    <p>
                                        Número de identificación fiscal (NIF) del obligado a expedir la factura.
                                    </p>
                                    <p>
                                        FormatoNIF(9).
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>CompanyName</code></td>
                                <td>
                                    <p>
                                        Nombre-razón social del vendedor.
                                    </p>
                                    <p>
                                        Alfanumérico(120).
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>RelatedPartyID</code></td>
                                <td>
                                    <p>
                                        Identificador del vendedor. Debe utilizarse el identificador fiscal si existe (NIF, VAT Number...).
                                        En caso de no existir, se puede utilizar el número de pasaporte, documento oficial de identificación
                                        expedido por el país o territorio de residencia; o cualquier otro identificador establecido.
                                    </p>
                                    <p>
                                        Alfanumérico(20).
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>RelatedPartyName</code></td>
                                <td>
                                    <p>
                                        Nombre-razón social del comprador.
                                    </p>
                                    <p>
                                        Alfanumérico(120).
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>RelatedPartyIDType</code></td>
                                <td>
                                    <p>
                                        Su valor por defecto es 02. Clave para establecer el tipo de identificación en el pais de residencia. L7.
                                    </p>
                                    <p>
                                        <ul style="list-style-type:square; padding-left: 4rem;">
                                            <li>02: NIF-IVA (02).</li>
                                            <li>03: PASAPORTE (03).</li>
                                            <li>04: DOCUMENTO OFICIAL DE IDENTIFICACIÓN EXPEDIDO POR EL PAÍS O TERRITORIO DE RESIDENCIA (04).</li>
                                            <li>05: CERTIFICADO DE RESIDENCIA (05).</li>
                                            <li>06: OTRO DOCUMENTO PROBATORIO (06).</li>
                                            <li>07: NO CENSADO (07).</li>
                                        </ul>
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>Text</code></td>
                                <td>
                                    <p>
                                        Descripción del objeto de la factura, equivalente al campo DescripcionOperacion.
                                    </p>
                                    <p>
                                        Alfanumérico (500).
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>TaxItems</code></td>
                                <td>
                                    <p>
                                        Colección de elementos <code>TaxItem</code> que recopila la información de las líneas de impuesto de la factura.
                                    </p>
                                    <p>
                                        Las propiedades del elemento <code>TaxItem</code> están recogidas en la siguiente tabla.
                                    </p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <br />
                <h1 style="text-align: left !important;">TaxItem</h1>
                <br />
                <p class="pb-4">
                    En la siguiente tabla se describe el valor de las propiedades de <code>TaxItem</code>:
                </p>
                <div class="table-responsive">
                    <table class="table table-striped align-start">
                        <thead>
                            <tr>
                                <th scope="col">Propiedad</th>
                                <th scope="col">Descripción</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>TaxScheme</code></td>
                                <td>
                                    <p>
                                        Su valor por defecto es 01. Esquema impositivo. Su valor por defecto es 0. Se corresponde con el campo ClaveRegimen del DetalleDesglose,
                                        e identifica el tipo de régimen del IVA o IGIC o una operación con trascendencia tributaria.
                                        Sus valores para el IVA y el IGIC están en las tablas L8A/L8B.
                                    </p>
                                    <p>
                                        Alfanumérico(2).
                                    </p>
                                    <p>
                                        <ul style="list-style-type:square; padding-left: 4rem;">
                                            <li> 01: Operación de régimen general ('01').</li>
                                            <li> 02: Exportación ('02').</li>
                                            <li> 03: Operaciones a las que se aplique el régimen especial de bienes usados, objetos de arte, antigüedades y objetos de colección ('03').</li>
                                            <li> 04: Régimen especial del oro de inversión ('04').</li>
                                            <li> 05: Régimen especial de las agencias de viajes ('05').</li>
                                            <li> 06: Régimen especial grupo de entidades en IVA/IGIC (Nivel Avanzado) ('06').</li>
                                            <li> 07: Régimen especial del criterio de caja ('07').</li>
                                            <li> 08: L8A y L8B: Operaciones sujetas al IPSI  / IGIC / IVA (Impuesto sobre la Producción, los Servicios y la Importación  / Impuesto General Indirecto Canario).</li>
                                            <li> 09: Facturación de las prestaciones de servicios de agencias de viaje que actúan como mediadoras en nombre y por cuenta ajena (D.A.4ª RD1619/2012) ('09').</li>
                                            <li> 10: Cobros por cuenta de terceros de honorarios profesionales o de derechos derivados de la propiedad industrial, de autor u otros por cuenta de sus socios, asociados o colegiados efectuados por sociedades, asociaciones, colegios profesionales u otras entidades que realicen estas funciones de cobro ('10').</li>
                                            <li> 11: Operaciones de arrendamiento de local de negocio ('11').</li>
                                            <li> 14: L8A y L8B: Factura con IVA / IGIC pendiente de devengo en certificaciones de obra cuyo destinatario sea una Administración Pública ('14').</li>
                                            <li> 15: L8A y L8B: Factura con IVA / IGIC pendiente de devengo en operaciones de tracto sucesivo ('15').</li>
                                            <li> 17: L8A: OSS e IOSS IVA. L8B: Régimen especial de comerciante minorista ('17').</li>
                                            <li> 18: L8A: Recargo de equivalencia. L8B: Régimen especial del pequeño empresario o profesional ('18').</li>
                                            <li> 19: L8A: Operaciones de actividades incluidas en el Régimen Especial de Agricultura, Ganadería y Pesca (REAGYP). L8B: Operaciones interiores exentas por aplicación artículo 25 Ley 19/1994 ('19').</li>
                                            <li> 20: Régimen simplificado sólo para IVA ('20').</li>
                                        </ul>
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>TaxType</code></td>
                                <td>
                                    <p>
                                        Su valor por defecto es S1. Se corresponde con el valor del campo CalificacionOperacion y es la clave de la operación sujeta y no exenta o de la operación no sujeta.
                                        Los valores que puede tener están relacionados con los de la lista L9.
                                    </p>
                                    <p>
                                        Alfanumérico(2).
                                    </p>
                                    <p>
                                        <ul style="list-style-type:square; padding-left: 4rem;">
                                            <li>S1: Operación Sujeta y No exenta - Sin inversión del sujeto pasivo.</li>
                                            <li>S2: Operación Sujeta y No exenta - Con Inversión del sujeto pasivo.</li>
                                            <li>N1: Operación No Sujeta artículo 7, 14, otros.</li>
                                            <li>N2: Operación No Sujeta por Reglas de localización.</li>
                                        </ul>
                                    </p>

                                </td>
                            </tr>
                            <tr>
                                <td><code>TaxException</code></td>
                                <td>
                                    <p>
                                        Se corresponde con el valor del campo OperacionExenta y es EL campo que especifica la causa de exención.
                                        Los valores que puede tener están relacionados con los de la lista L10.
                                    </p>
                                    <p>
                                        Alfanumérico(2).
                                    </p>
                                    <p>
                                        <ul style="list-style-type:square; padding-left: 4rem;">
                                            <li> E1: Exenta por el artículo 20.</li>
                                            <li> E2: Exenta por el artículo 21.</li>
                                            <li> E3: Exenta por el artículo 22.</li>
                                            <li> E4: Exenta por los artículos 23 y 24.</li>
                                            <li> E5: Exenta por el artículo 25.</li>
                                            <li> E6: Exenta por otros.</li>
                                        </ul>
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>TaxBase</code></td>
                                <td>
                                    <p>
                                        Base imponible. Se corresponde con el campo BaseImponibleOimporteNoSujeto o con el campo BaseImponibleACoste en grupos nivel avanzado,
                                        es la magnitud dineraria sobre  la que se aplica aplica el tipo impositivo.
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>TaxRate</code></td>
                                <td>
                                    <p>
                                        Tipo impositivo. Se corresponde con el campo TipoImpositivo, y es el porcentaje aplicado sobre la base imponible para calcular la cuota.
                                    </p>
                                    <p>
                                        Decimal(3,2).
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>TaxAmount</code></td>
                                <td>
                                    <p>
                                        Importe cuota impuesto. Se corresponde con el campo CuotaRepercutida, y es la cuota resultante de aplicar a la base imponible el tipo impositivo.
                                    </p>
                                    <p>
                                        Decimal(12,2).
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>TaxRateSurcharge</code></td>
                                <td>
                                    <p>
                                        Tipo impositivo recargo. Se corresponde con el campo TipoRecargoEquivalencia, y es el porcentaje asociado en función del impuesto y tipo impositivo
                                        aplicado sobre la base imponible para calcular la cuota del recargo de equivalencia.
                                    </p>
                                    <p>
                                        Decimal(3,2).
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>TaxAmountSurcharge</code></td>
                                <td>
                                    <p>
                                        Importe cuota recargo impuesto. Se corresponde con el campo CuotaRecargoEquivalencia, y es la cuota resultante de aplicar a la base imponible el tipo de recargo de equivalencia.
                                    </p>
                                    <p>
                                        Decimal(12,2).
                                    </p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <br />
                <h1 style="text-align: left !important;">Result</h1>
                <br />
                <p>
                    La respuesta devuelta se trata de un objeto <code>Result</code>. El objeto <code>Result</code> contiene las propiedades <code>ResultCode</code>, <code>ResultMessage</code> y <code>Return</code>:

                    <ul>
                        <li><strong>ResultCode:</strong> Si todo ha ido correctamente devuelve el valor 0, en caso contrario devolverá un código de error.</li>
                        <li><strong>ResultMessage:</strong> Mensaje descriptivo de cómo ha sido el resultado.</li>
                        <li><strong>Return:</strong> Objeto con el resultado de la operación.</li>
                    </ul>

                </p>
                <br />
                <p class="pb-4">
                    El objeto <code>Return</code> contiene las mismas propiedades que el objeto <code>Invoice</code> más los resultados del procesamiento de la llamada. En la siguiente tabla se describe el valor de las propiedades de <code>Return</code> adicionales:
                </p>
                <div class="table-responsive">
                    <table class="table table-striped align-start">
                        <thead>
                            <tr>
                                <th scope="col">Propiedad</th>
                                <th scope="col">Descripción</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><code>ExternKey</code></td>
                                <td>
                                    <p>
                                        Representa el identificador del eslabón de la cadena de bloques correspondiente a la factura identificada.
                                    </p>
                                    <p>
                                        Alfanumérico(20).
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>StatusResponse</code></td>
                                <td>
                                    <p>
                                        Estado asignado por la AEAT a la respuesto. Si todo ha ido bien devuelve el valor 'Correcto'.
                                    </p>
                                    <p>
                                        Alfanumérico(20).
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>ErrorCode</code></td>
                                <td>
                                    <p>
                                        Código de error devuelto por el servidor de la AEAT. Si todo ha ido bien su valor será null.
                                    </p>
                                    <p>
                                        Alfanumérico(100).
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>ErrorDescription</code></td>
                                <td>
                                    <p>
                                        Descripción del error devuelto por el servidor de la AEAT. Si todo ha ido bien su valor será null.
                                    </p>
                                    <p>
                                        Alfanumérico(1000).
                                    </p>

                                </td>
                            </tr>
                            <tr>
                                <td><code>CSV</code></td>
                                <td>
                                    <p>
                                        Código seguro de verificación (CSV) devuelto por la AEAT. Si todo ha ido bien debe contener un valor distinto de null.
                                    </p>
                                    <p>
                                        Alfanumérico(100).
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>QrCode</code></td>
                                <td>
                                    <p>
                                        Imagen en formato mapa de bits (.bmp) codificada en base 64.
                                    </p>
                                    <p>
                                        Bytes.
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>Xml</code></td>
                                <td>
                                    <p>
                                        Archivo XML envíado a la AEAT.
                                    </p>
                                    <p>
                                        String.
                                    </p>
                                </td>
                            </tr>
                            <tr>
                                <td><code>Response</code></td>
                                <td>
                                    <p>
                                        Archivo XML de respuesta de la AEAT.
                                    </p>
                                    <p>
                                        String.
                                    </p>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </form>
        </div>
    </main>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-OERcA2EqjJCMA+/3y+gxIOqMEjwtxJY7qPCqsdltbNJuaOe923+mo//f6V8Qbsw3" crossorigin="anonymous"></script>
    <script src="../js/Kivu.Client.0.0.12.js"></script>
    <script src="../js/Wefinz.Pages.ModelView.js"></script>
    <script src="go.js"></script>
</body>
</html>